/*! angular-dropdown-tree <ammeyjohn@qq.com> 2016-02-06 */
!function(a,b){"use strict";function c(){return{restrict:"EA",replace:!0,scope:{multiple:"@dropdownTreeMultiple",treeData:"=dropdownTreeData"},require:"ngModel",templateUrl:"template.html",link:function(c,e,f,g){var h=Math.random().toString(36).substr(2);c.dLabel="dLabel_"+h;var i=null,j=function(a){var e=b.copy(d);return e=b.extend({},e),c.treeData&&(e.core.data=a),n()&&e.plugins.push("checkbox"),e},k=function(a){var b="";if(a.length>3)b="选中"+a.length+"项";else{for(var d=0;d<a.length;d++){var e=a[d],f=e;e.text?f=e.text:e.title?f=e.title:e.id&&(f=e.id),b+=","+f}b=b.substr(1)}c.dropdown_title=b},l=function(b){i=a(e).find("div.dropdown-menu div"),0==i.length&&(i=a("<div />"),a(e).find("div.dropdown-menu").append(i));var d=j(b);i.on("changed.jstree",function(b,d){var f=[];for(var h in d.selected){var i=d.instance.get_node(d.selected[h]);f.push(i.original)}c.$apply(function(){g.$setViewValue(f),k(f)}),n()||a(e).removeClass("open")}).on("click",function(a){a.stopPropagation()}).jstree(d)},m=function(){i&&(i.jstree("destroy"),i.remove(),i=null)},n=function(){return"true"==c.multiple.toLowerCase()};c.$watch("treeData",function(a){a&&(m(),l(a))})}}}var d={plugins:["changed"],core:{check_callback:!0,data:[]}},e=b.module("uiDropdownTree",[]);e.directive("uiDropdownTree",c)}(jQuery,angular),angular.module("uiDropdownTree").run(["$templateCache",function(a){"use strict";a.put("template.html",'<div class="dropdown">\n    <button id="{{dLabel}}" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n        {{dropdown_title}}\n        <span class="caret"></span>\n    </button>\n    <div class="dropdown-menu" aria-labelledby="{{dLabel}}"></div>\n</div>\n')}]);